{"ast":null,"code":"","map":{"version":3,"names":[],"sources":["C:/APP/Acessibilidade 01/src/pages/AreaRestrita/Locais/index.js"],"sourcesContent":["/*import React, { useState, useEffect } from 'react';\r\nimport { View, Text, TouchableOpacity, Alert, TextInput, SafeAreaView, StatusBar } from 'react-native';\r\nimport css from '../../../css/css.js';\r\nimport { Feather as Icon } from '@expo/vector-icons';\r\nimport MenuAreaRestrita from '../MenuAreaRestrita/index.js';\r\nimport config from '../../../config/config.json';\r\nimport { Table, Row, Rows } from 'react-native-table-component';\r\nimport Modal from 'react-native-modal';\r\n\r\nexport default function Locais({ navigation }) {\r\n    const [data, setData] = useState([]);\r\n    const [isModalVisibleMensage, setIsModalVisibleMensage] = useState(false);\r\n    const [modalMesage, setModalMesage] = useState('');\r\n    const [isModalVisibleQr, setIsModalVisibleQr] = useState(false);\r\n    const [modalQr, setModalQr] = useState('');\r\n\r\n    const [isModalVisibleAudio, setIsModalVisibleAudio] = useState(false);\r\n    const [modalAudio, setModalAudio] = useState('');\r\n    const [isModalVisibleImagem, setIsModalVisibleImagem] = useState(false);\r\n    const [modalImagem, setModalImagem] = useState('');\r\n    const [searchText, setSearchText] = useState('');\r\n    const [isFormVisible, setIsFormVisible] = useState(false);\r\n \r\n    const [localData, setLocalData] = useState({\r\n        local: '',\r\n        mensagem1: '',\r\n        audio: '',\r\n        imagem: '',\r\n        qr: '',\r\n    });\r\n\r\n    useEffect(() => {\r\n        buscaDados();\r\n        StatusBar.setHidden(true);\r\n\r\n    }, []);\r\n\r\n    const buscaDados = async () => {\r\n        try {\r\n            const response = await fetch(`${config.urlRoot}locais/`);\r\n            const data = await response.json();\r\n            setData(data);\r\n        } catch (error) {\r\n            console.error('Erro ao buscar dados:', error);\r\n        }\r\n    };\r\n\r\n    const filtrarDados = () => {\r\n        if (searchText === '') {\r\n            return data;\r\n        }\r\n        return data.filter((item) =>\r\n            item.local.toLowerCase().includes(searchText.toLowerCase())\r\n        );\r\n    };\r\n\r\n    const Deletar = async (item) => {\r\n        Alert.alert(\r\n            'Confirmação',\r\n            'Tem certeza de que deseja excluir este item?',\r\n            [\r\n                { text: 'Cancelar', style: 'cancel' },\r\n                {\r\n                    text: 'Excluir',\r\n                    onPress: async () => {\r\n                        try {\r\n                            const response = await fetch(`${config.urlRoot}locais/${item.id}`, {\r\n                                method: 'Delete',\r\n                            });\r\n\r\n                            if (response.ok) {\r\n                                // A exclusão foi bem-sucedida\r\n                                buscaDados();\r\n                            } else {\r\n                                console.error('Erro ao excluir o item:', response.status);\r\n                            }\r\n                        } catch (error) {\r\n                            console.error('Erro ao excluir o item:', error);\r\n                        }\r\n                    },\r\n                },\r\n            ],\r\n            { cancelable: false }\r\n        );\r\n    };\r\n\r\n    const Msg = (item) => {\r\n        setModalMesage(item.mensagem1);\r\n        setIsModalVisibleMensage(true);\r\n    };\r\n\r\n    const QrCode = (item) => {\r\n        setModalQr(item.qr);\r\n        setIsModalVisibleQr(true);\r\n    };\r\n\r\n    const Audio = (item) => {\r\n        setModalAudio(item.audio);\r\n        setIsModalVisibleAudio(true);\r\n    };\r\n\r\n    const Imagem = (item) => {\r\n        setModalImagem(item.imagem);\r\n        setIsModalVisibleImagem(true);\r\n    };\r\n\r\n    const handleAddLocal = async () => {\r\n        setIsFormVisible(true);\r\n        try {\r\n            const response = await fetch(`${config.urlRoot}locais/`, {\r\n                method: 'POST',\r\n                body: JSON.stringify(localData),\r\n                headers: { 'Content-Type': 'application/json' },\r\n            });\r\n\r\n            if (response.ok) {\r\n                buscaDados();\r\n            } else {\r\n                console.error('Erro ao adicionar o local:', response.error);\r\n            }\r\n        } catch (error) {\r\n            console.error('Erro ao adicionar o local:', error);\r\n            setErrorResponse(error.message);\r\n        }\r\n    };\r\n\r\n    const handleEditLocal = async (item) => {\r\n        setIsFormVisible(true);\r\n        setLocalData({\r\n            local: item.local || '',\r\n            mensagem1: item.mensagem1 || '',\r\n            audio: item.audio || '',\r\n            imagem: item.imagem || '',\r\n            qr: item.qr || '',\r\n            id: item.id || ''\r\n        });\r\n        try {\r\n            const response = await fetch(`${config.urlRoot}locais/${localData.id}`, {\r\n                method: 'PUT',\r\n                body: JSON.stringify(localData),\r\n                headers: { 'Content-Type': 'application/json' },\r\n            });\r\n            if (response.ok) {\r\n                buscaDados();\r\n            }\r\n        } catch (error) {\r\n            console.error('Erro ao editar o local: ', error);\r\n        }\r\n    };\r\n\r\n    const handleCloseForm = () => {\r\n        setIsFormVisible(false);\r\n        setLocalData({});\r\n    };\r\n\r\n    const handleSave = async (item) => {\r\n        if (localData.local === '') {\r\n            Alert.alert('Erro ao salvar', 'O campo local deve ser preenchido', [\r\n                { text: 'OK', style: 'cancel' },\r\n            ]);\r\n            return;\r\n        }\r\n        if (localData.mensagem1 === '') {\r\n            Alert.alert('Erro ao salvar', 'O campo mensagem 1 deve ser preenchido', [\r\n                { text: 'OK', style: 'cancel' },\r\n            ]);\r\n            return;\r\n        }\r\n        if (localData.audio === '') {\r\n            Alert.alert('Erro ao salvar', 'O campo audio deve ser preenchido', [\r\n                { text: 'OK', style: 'cancel' },\r\n            ]);\r\n            return;\r\n        }\r\n        if (localData.imagem === '') {\r\n            Alert.alert('Erro ao salvar', 'O campo imagem deve ser preenchido', [\r\n                { text: 'OK', style: 'cancel' },\r\n            ]);\r\n            return;\r\n        }\r\n        if (localData.qr === '') {\r\n            Alert.alert('Erro ao salvar', 'O campo qr deve ser preenchido', [\r\n                { text: 'OK', style: 'cancel' },\r\n            ]);\r\n            return;\r\n        }\r\n\r\n        if (localData.id) {\r\n            await handleEditLocal(localData);            \r\n        } else {\r\n            await handleAddLocal();            \r\n        }\r\n        setIsFormVisible(false);\r\n        setLocalData({\r\n            local: '',\r\n            desc_local: '',\r\n            ambiente: '',\r\n            desc_ambiente: '',\r\n            imagem: '',\r\n            qr: ''            \r\n        });\r\n    };\r\n\r\n    return (\r\n        <SafeAreaView style={css.container}>\r\n            <View>\r\n                <MenuAreaRestrita title=\"Locais\" navigation={navigation} />\r\n                <TextInput\r\n                    style={css.searchInput}\r\n                    placeholder=\"Digite aqui o nome do local...\"\r\n                    value={searchText}\r\n                    onChangeText={(text) => setSearchText(text)}\r\n                />\r\n                <Table style={css.tableContainerListar}>\r\n                    <Row\r\n                        data={['Local', 'Msg', 'Audio', 'Imagem', ' QR', 'Ações']}\r\n                        style={css.tableHeadListar}\r\n                    />\r\n                    <Rows\r\n                        data={filtrarDados().map((item) => [\r\n                            item.local,\r\n                            item.mensagem1 ? (\r\n                                <View style={[css.actionContainerListar]}>\r\n                                    <TouchableOpacity\r\n                                        style={css.buttonListar}\r\n                                        onPress={() => Msg(item)}\r\n                                    >\r\n                                        <Icon name=\"list\" color=\"black\" size={15} />\r\n                                    </TouchableOpacity>\r\n                                </View>\r\n                            ) : null,\r\n                            item.audio ? (\r\n                                <View style={[css.actionContainerListar]}>\r\n                                    <TouchableOpacity\r\n                                        style={css.buttonListar}\r\n                                        onPress={() => Audio(item)}\r\n                                    >\r\n                                        <Icon name=\"mic\" color=\"black\" size={15} />\r\n                                    </TouchableOpacity>\r\n                                </View>\r\n                            ) : null,\r\n                            item.imagem ? (\r\n                                <View style={[css.actionContainerListar]}>\r\n                                    <TouchableOpacity\r\n                                        style={css.buttonListar}\r\n                                        onPress={() => Imagem(item)}\r\n                                    >\r\n                                        <Icon name=\"image\" color=\"black\" size={15} />\r\n                                    </TouchableOpacity>\r\n                                </View>\r\n                            ) : null,\r\n                            item.qr ? (\r\n                                <View style={[css.actionContainerListar]}>\r\n                                    <TouchableOpacity\r\n                                        style={css.buttonListar}\r\n                                        onPress={() => QrCode(item)}\r\n                                    >\r\n                                        <Icon name=\"grid\" color=\"black\" size={15} />\r\n                                    </TouchableOpacity>\r\n                                </View>\r\n                            ) : null,\r\n                            <View style={[css.actionContainerListar]}>\r\n                                <TouchableOpacity\r\n                                    style={css.buttonListar}\r\n                                    onPress={() => handleEditLocal(item)}\r\n                                >\r\n                                    <Icon name=\"edit\" color=\"black\" size={15} />\r\n                                </TouchableOpacity>\r\n                                <TouchableOpacity\r\n                                    style={css.buttonListar}\r\n                                    onPress={() => Deletar(item)}\r\n                                >\r\n                                    <Icon name=\"trash\" color=\"black\" size={15} />\r\n                                </TouchableOpacity>\r\n                            </View>,\r\n                        ])}\r\n                        style={css.tableRowSeparatorListar}\r\n                    />\r\n                </Table>\r\n\r\n                <Modal isVisible={isModalVisibleMensage}>\r\n                    <View style={css.modalContainer}>\r\n                        <Text style={css.modalTitle}>Mensagem:</Text>\r\n                        <Text style={css.modalMesage}>{modalMesage}</Text>\r\n                        <TouchableOpacity\r\n                            style={css.modalButton}\r\n                            onPress={() => setIsModalVisibleMensage(false)}\r\n                        >\r\n                            <Text style={css.modalButtonText}>Fechar</Text>\r\n                        </TouchableOpacity>\r\n                    </View>\r\n                </Modal>\r\n                <Modal isVisible={isModalVisibleQr}>\r\n                    <View style={css.modalContainer}>\r\n                        <Text style={css.modalTitle}>O código do QrCode Informado foi:</Text>\r\n                        <Text style={css.modalMesage}>{modalQr}</Text>\r\n                        <TouchableOpacity\r\n                            style={css.modalButton}\r\n                            onPress={() => setIsModalVisibleQr(false)}\r\n                        >\r\n                            <Text style={css.modalButtonText}>Fechar</Text>\r\n                        </TouchableOpacity>\r\n                    </View>\r\n                </Modal>\r\n                <Modal isVisible={isModalVisibleAudio}>\r\n                    <View style={css.modalContainer}>\r\n                        <Text style={css.modalTitle}>O código do áudio informado foi:</Text>\r\n                        <Text style={css.modalMesage}>{modalAudio}</Text>\r\n                        <TouchableOpacity\r\n                            style={css.modalButton}\r\n                            onPress={() => setIsModalVisibleAudio(false)}\r\n                        >\r\n                            <Text style={css.modalButtonText}>Fechar</Text>\r\n                        </TouchableOpacity>\r\n                    </View>\r\n                </Modal>\r\n\r\n                <Modal isVisible={isModalVisibleImagem}>\r\n                    <View style={css.modalContainer}>\r\n                        <Text style={css.modalTitle}>O código do imagem informado foi</Text>\r\n                        <Text style={css.modalMesage}>{modalImagem}</Text>\r\n                        <TouchableOpacity\r\n                            style={css.modalButton}\r\n                            onPress={() => setIsModalVisibleImagem(false)}\r\n                        >\r\n                            <Text style={css.modalButtonText}>Fechar</Text>\r\n                        </TouchableOpacity>\r\n                    </View>\r\n                </Modal>\r\n\r\n                <Modal isVisible={isFormVisible}>\r\n                    <View style={css.modalContainer}>\r\n                        <Text style={css.formLabel}>Local:</Text>\r\n                        <TextInput\r\n                            style={css.formInput}\r\n                            value={localData.local}\r\n                            onChangeText={(text) =>\r\n                                setLocalData((prevData) => ({ ...prevData, local: text }))\r\n                            }\r\n                            placeholder=\"Digite o local\"\r\n                        />\r\n                        <Text style={css.formLabel}>Mensagem:</Text>\r\n                        <TextInput\r\n                            style={css.formInput}\r\n                            value={localData.mensagem1}\r\n                            onChangeText={(text) =>\r\n                                setLocalData((prevData) => ({ ...prevData, mensagem1: text }))\r\n                            }\r\n                            placeholder=\"Digite a mensagem\"\r\n                        />\r\n\r\n                        <Text style={css.formLabel}>Áudio:</Text>\r\n                        <TextInput\r\n                            style={css.formInput}\r\n                            value={localData.audio}\r\n                            onChangeText={(text) =>\r\n                                setLocalData((prevData) => ({ ...prevData, audio: text }))\r\n                            }\r\n                            placeholder=\"Digite o áudio\"\r\n                        />\r\n\r\n                        <Text style={css.formLabel}>Imagem:</Text>\r\n                        <TextInput\r\n                            style={css.formInput}\r\n                            value={localData.imagem}\r\n                            onChangeText={(text) =>\r\n                                setLocalData((prevData) => ({ ...prevData, imagem: text }))\r\n                            }\r\n                            placeholder=\"Digite a imagem\"\r\n                        />\r\n\r\n                        <Text style={css.formLabel}>QR:</Text>\r\n                        <TextInput\r\n                            style={css.formInput}\r\n                            value={localData.qr}\r\n                            onChangeText={(text) =>\r\n                                setLocalData((prevData) => ({ ...prevData, qr: text }))\r\n                            }\r\n                            placeholder=\"Digite o QR\"\r\n                        />\r\n                        <TouchableOpacity style={css.formButton} onPress={handleSave}>\r\n                            <Text style={css.formButtonText}>Salvar</Text>\r\n                        </TouchableOpacity>\r\n                        <TouchableOpacity style={css.formButton} onPress={handleCloseForm}>\r\n                            <Text style={css.formButtonText}>Cancelar</Text>\r\n                        </TouchableOpacity>\r\n                    </View>\r\n                </Modal>\r\n            </View>\r\n            <View style={css.buttonIncluir}>\r\n                <TouchableOpacity onPress={() => setIsFormVisible(true)}>\r\n                    <Text style={css.buttonIncluirText}>+</Text>\r\n                </TouchableOpacity>\r\n            </View>\r\n        </SafeAreaView  >\r\n    );\r\n}*/"],"mappings":""},"metadata":{},"sourceType":"script","externalDependencies":[]}